function BigInteger(t,i,r){null!=t&&("number"==typeof t?this.fromNumber(t,i,r):null==i&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,i))}function nbi(){return new BigInteger(null)}function am1(t,i,r,n,e,o){for(;--o>=0;){var s=i*this[t++]+r[n]+e;e=Math.floor(s/67108864),r[n++]=67108863&s}return e}function am2(t,i,r,n,e,o){for(var s=32767&i,h=i>>15;--o>=0;){var p=32767&this[t],u=this[t++]>>15,f=h*p+u*s;p=s*p+((32767&f)<<15)+r[n]+(1073741823&e),e=(p>>>30)+(f>>>15)+h*u+(e>>>30),r[n++]=1073741823&p}return e}function am3(t,i,r,n,e,o){for(var s=16383&i,h=i>>14;--o>=0;){var p=16383&this[t],u=this[t++]>>14,f=h*p+u*s;p=s*p+((16383&f)<<14)+r[n]+e,e=(p>>28)+(f>>14)+h*u,r[n++]=268435455&p}return e}function int2char(t){return BI_RM.charAt(t)}function intAt(t,i){var r=BI_RC[t.charCodeAt(i)];return null==r?-1:r}function bnpCopyTo(t){for(var i=this.t-1;i>=0;--i)t[i]=this[i];t.t=this.t,t.s=this.s}function bnpFromInt(t){this.t=1,this.s=0>t?-1:0,t>0?this[0]=t:-1>t?this[0]=t+this.DV:this.t=0}function nbv(t){var i=nbi();return i.fromInt(t),i}function bnpFromString(t,i){var r;if(16==i)r=4;else if(8==i)r=3;else if(256==i)r=8;else if(2==i)r=1;else if(32==i)r=5;else{if(4!=i)return void this.fromRadix(t,i);r=2}this.t=0,this.s=0;for(var n=t.length,e=!1,o=0;--n>=0;){var s=8==r?255&t[n]:intAt(t,n);0>s?"-"==t.charAt(n)&&(e=!0):(e=!1,0==o?this[this.t++]=s:o+r>this.DB?(this[this.t-1]|=(s&(1<<this.DB-o)-1)<<o,this[this.t++]=s>>this.DB-o):this[this.t-1]|=s<<o,o+=r,o>=this.DB&&(o-=this.DB))}8==r&&0!=(128&t[0])&&(this.s=-1,o>0&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),e&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t}function bnToString(t){if(this.s<0)return"-"+this.negate().toString(t);var i;if(16==t)i=4;else if(8==t)i=3;else if(2==t)i=1;else if(32==t)i=5;else{if(4!=t)return this.toRadix(t);i=2}var r,n=(1<<i)-1,e=!1,o="",s=this.t,h=this.DB-s*this.DB%i;if(s-->0)for(h<this.DB&&(r=this[s]>>h)>0&&(e=!0,o=int2char(r));s>=0;)i>h?(r=(this[s]&(1<<h)-1)<<i-h,r|=this[--s]>>(h+=this.DB-i)):(r=this[s]>>(h-=i)&n,0>=h&&(h+=this.DB,--s)),r>0&&(e=!0),e&&(o+=int2char(r));return e?o:"0"}function bnNegate(){var t=nbi();return BigInteger.ZERO.subTo(this,t),t}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(t){var i=this.s-t.s;if(0!=i)return i;var r=this.t;if(i=r-t.t,0!=i)return this.s<0?-i:i;for(;--r>=0;)if(0!=(i=this[r]-t[r]))return i;return 0}function nbits(t){var i,r=1;return 0!=(i=t>>>16)&&(t=i,r+=16),0!=(i=t>>8)&&(t=i,r+=8),0!=(i=t>>4)&&(t=i,r+=4),0!=(i=t>>2)&&(t=i,r+=2),0!=(i=t>>1)&&(t=i,r+=1),r}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(t,i){var r;for(r=this.t-1;r>=0;--r)i[r+t]=this[r];for(r=t-1;r>=0;--r)i[r]=0;i.t=this.t+t,i.s=this.s}function bnpDRShiftTo(t,i){for(var r=t;r<this.t;++r)i[r-t]=this[r];i.t=Math.max(this.t-t,0),i.s=this.s}function bnpLShiftTo(t,i){var r,n=t%this.DB,e=this.DB-n,o=(1<<e)-1,s=Math.floor(t/this.DB),h=this.s<<n&this.DM;for(r=this.t-1;r>=0;--r)i[r+s+1]=this[r]>>e|h,h=(this[r]&o)<<n;for(r=s-1;r>=0;--r)i[r]=0;i[s]=h,i.t=this.t+s+1,i.s=this.s,i.clamp()}function bnpRShiftTo(t,i){i.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t)return void(i.t=0);var n=t%this.DB,e=this.DB-n,o=(1<<n)-1;i[0]=this[r]>>n;for(var s=r+1;s<this.t;++s)i[s-r-1]|=(this[s]&o)<<e,i[s-r]=this[s]>>n;n>0&&(i[this.t-r-1]|=(this.s&o)<<e),i.t=this.t-r,i.clamp()}function bnpSubTo(t,i){for(var r=0,n=0,e=Math.min(t.t,this.t);e>r;)n+=this[r]-t[r],i[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this[r],i[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t[r],i[r++]=n&this.DM,n>>=this.DB;n-=t.s}i.s=0>n?-1:0,-1>n?i[r++]=this.DV+n:n>0&&(i[r++]=n),i.t=r,i.clamp()}function bnpMultiplyTo(t,i){var r=this.abs(),n=t.abs(),e=r.t;for(i.t=e+n.t;--e>=0;)i[e]=0;for(e=0;e<n.t;++e)i[e+r.t]=r.am(0,n[e],i,e,0,r.t);i.s=0,i.clamp(),this.s!=t.s&&BigInteger.ZERO.subTo(i,i)}function bnpSquareTo(t){for(var i=this.abs(),r=t.t=2*i.t;--r>=0;)t[r]=0;for(r=0;r<i.t-1;++r){var n=i.am(r,i[r],t,2*r,0,1);(t[r+i.t]+=i.am(r+1,2*i[r],t,2*r+1,n,i.t-r-1))>=i.DV&&(t[r+i.t]-=i.DV,t[r+i.t+1]=1)}t.t>0&&(t[t.t-1]+=i.am(r,i[r],t,2*r,0,1)),t.s=0,t.clamp()}function bnpDivRemTo(t,i,r){var n=t.abs();if(!(n.t<=0)){var e=this.abs();if(e.t<n.t)return null!=i&&i.fromInt(0),void(null!=r&&this.copyTo(r));null==r&&(r=nbi());var o=nbi(),s=this.s,h=t.s,p=this.DB-nbits(n[n.t-1]);p>0?(n.lShiftTo(p,o),e.lShiftTo(p,r)):(n.copyTo(o),e.copyTo(r));var u=o.t,f=o[u-1];if(0!=f){var a=f*(1<<this.F1)+(u>1?o[u-2]>>this.F2:0),b=this.FV/a,g=(1<<this.F1)/a,l=1<<this.F2,m=r.t,c=m-u,v=null==i?nbi():i;for(o.dlShiftTo(c,v),r.compareTo(v)>=0&&(r[r.t++]=1,r.subTo(v,r)),BigInteger.ONE.dlShiftTo(u,v),v.subTo(o,o);o.t<u;)o[o.t++]=0;for(;--c>=0;){var B=r[--m]==f?this.DM:Math.floor(r[m]*b+(r[m-1]+l)*g);if((r[m]+=o.am(0,B,r,c,0,u))<B)for(o.dlShiftTo(c,v),r.subTo(v,r);r[m]<--B;)r.subTo(v,r)}null!=i&&(r.drShiftTo(u,i),s!=h&&BigInteger.ZERO.subTo(i,i)),r.t=u,r.clamp(),p>0&&r.rShiftTo(p,r),0>s&&BigInteger.ZERO.subTo(r,r)}}}function bnMod(t){var i=nbi();return this.abs().divRemTo(t,null,i),this.s<0&&i.compareTo(BigInteger.ZERO)>0&&t.subTo(i,i),i}function Classic(t){this.m=t}function cConvert(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function cRevert(t){return t}function cReduce(t){t.divRemTo(this.m,null,t)}function cMulTo(t,i,r){t.multiplyTo(i,r),this.reduce(r)}function cSqrTo(t,i){t.squareTo(i),this.reduce(i)}function bnpInvDigit(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var i=3&t;return i=i*(2-(15&t)*i)&15,i=i*(2-(255&t)*i)&255,i=i*(2-((65535&t)*i&65535))&65535,i=i*(2-t*i%this.DV)%this.DV,i>0?this.DV-i:-i}function Montgomery(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function montConvert(t){var i=nbi();return t.abs().dlShiftTo(this.m.t,i),i.divRemTo(this.m,null,i),t.s<0&&i.compareTo(BigInteger.ZERO)>0&&this.m.subTo(i,i),i}function montRevert(t){var i=nbi();return t.copyTo(i),this.reduce(i),i}function montReduce(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var i=0;i<this.m.t;++i){var r=32767&t[i],n=r*this.mpl+((r*this.mph+(t[i]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=i+this.m.t,t[r]+=this.m.am(0,n,t,i,0,this.m.t);t[r]>=t.DV;)t[r]-=t.DV,t[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function montSqrTo(t,i){t.squareTo(i),this.reduce(i)}function montMulTo(t,i,r){t.multiplyTo(i,r),this.reduce(r)}function bnpIsEven(){return 0==(this.t>0?1&this[0]:this.s)}function bnpExp(t,i){if(t>4294967295||1>t)return BigInteger.ONE;var r=nbi(),n=nbi(),e=i.convert(this),o=nbits(t)-1;for(e.copyTo(r);--o>=0;)if(i.sqrTo(r,n),(t&1<<o)>0)i.mulTo(n,e,r);else{var s=r;r=n,n=s}return i.revert(r)}function bnModPowInt(t,i){var r;return r=256>t||i.isEven()?new Classic(i):new Montgomery(i),this.exp(t,r)}function bnClone(){var t=nbi();return this.copyTo(t),t}function bnIntValue(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnByteValue(){return 0==this.t?this.s:this[0]<<24>>24}function bnShortValue(){return 0==this.t?this.s:this[0]<<16>>16}function bnpChunkSize(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function bnSigNum(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function bnpToRadix(t){if(null==t&&(t=10),0==this.signum()||2>t||t>36)return"0";var i=this.chunkSize(t),r=Math.pow(t,i),n=nbv(r),e=nbi(),o=nbi(),s="";for(this.divRemTo(n,e,o);e.signum()>0;)s=(r+o.intValue()).toString(t).substr(1)+s,e.divRemTo(n,e,o);return o.intValue().toString(t)+s}function bnpFromRadix(t,i){this.fromInt(0),null==i&&(i=10);for(var r=this.chunkSize(i),n=Math.pow(i,r),e=!1,o=0,s=0,h=0;h<t.length;++h){var p=intAt(t,h);0>p?"-"==t.charAt(h)&&0==this.signum()&&(e=!0):(s=i*s+p,++o>=r&&(this.dMultiply(n),this.dAddOffset(s,0),o=0,s=0))}o>0&&(this.dMultiply(Math.pow(i,o)),this.dAddOffset(s,0)),e&&BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(t,i,r){if("number"==typeof i)if(2>t)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(t-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(i);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(BigInteger.ONE.shiftLeft(t-1),this);else{var n=new Array,e=7&t;n.length=(t>>3)+1,i.nextBytes(n),e>0?n[0]&=(1<<e)-1:n[0]=0,this.fromString(n,256)}}function bnToByteArray(){var t=this.t,i=new Array;i[0]=this.s;var r,n=this.DB-t*this.DB%8,e=0;if(t-->0)for(n<this.DB&&(r=this[t]>>n)!=(this.s&this.DM)>>n&&(i[e++]=r|this.s<<this.DB-n);t>=0;)8>n?(r=(this[t]&(1<<n)-1)<<8-n,r|=this[--t]>>(n+=this.DB-8)):(r=this[t]>>(n-=8)&255,0>=n&&(n+=this.DB,--t)),0!=(128&r)&&(r|=-256),0==e&&(128&this.s)!=(128&r)&&++e,(e>0||r!=this.s)&&(i[e++]=r);return i}function bnEquals(t){return 0==this.compareTo(t)}function bnMin(t){return this.compareTo(t)<0?this:t}function bnMax(t){return this.compareTo(t)>0?this:t}function bnpBitwiseTo(t,i,r){var n,e,o=Math.min(t.t,this.t);for(n=0;o>n;++n)r[n]=i(this[n],t[n]);if(t.t<this.t){for(e=t.s&this.DM,n=o;n<this.t;++n)r[n]=i(this[n],e);r.t=this.t}else{for(e=this.s&this.DM,n=o;n<t.t;++n)r[n]=i(e,t[n]);r.t=t.t}r.s=i(this.s,t.s),r.clamp()}function op_and(t,i){return t&i}function bnAnd(t){var i=nbi();return this.bitwiseTo(t,op_and,i),i}function op_or(t,i){return t|i}function bnOr(t){var i=nbi();return this.bitwiseTo(t,op_or,i),i}function op_xor(t,i){return t^i}function bnXor(t){var i=nbi();return this.bitwiseTo(t,op_xor,i),i}function op_andnot(t,i){return t&~i}function bnAndNot(t){var i=nbi();return this.bitwiseTo(t,op_andnot,i),i}function bnNot(){for(var t=nbi(),i=0;i<this.t;++i)t[i]=this.DM&~this[i];return t.t=this.t,t.s=~this.s,t}function bnShiftLeft(t){var i=nbi();return 0>t?this.rShiftTo(-t,i):this.lShiftTo(t,i),i}function bnShiftRight(t){var i=nbi();return 0>t?this.lShiftTo(-t,i):this.rShiftTo(t,i),i}function lbit(t){if(0==t)return-1;var i=0;return 0==(65535&t)&&(t>>=16,i+=16),0==(255&t)&&(t>>=8,i+=8),0==(15&t)&&(t>>=4,i+=4),0==(3&t)&&(t>>=2,i+=2),0==(1&t)&&++i,i}function bnGetLowestSetBit(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+lbit(this[t]);return this.s<0?this.t*this.DB:-1}function cbit(t){for(var i=0;0!=t;)t&=t-1,++i;return i}function bnBitCount(){for(var t=0,i=this.s&this.DM,r=0;r<this.t;++r)t+=cbit(this[r]^i);return t}function bnTestBit(t){var i=Math.floor(t/this.DB);return i>=this.t?0!=this.s:0!=(this[i]&1<<t%this.DB)}function bnpChangeBit(t,i){var r=BigInteger.ONE.shiftLeft(t);return this.bitwiseTo(r,i,r),r}function bnSetBit(t){return this.changeBit(t,op_or)}function bnClearBit(t){return this.changeBit(t,op_andnot)}function bnFlipBit(t){return this.changeBit(t,op_xor)}function bnpAddTo(t,i){for(var r=0,n=0,e=Math.min(t.t,this.t);e>r;)n+=this[r]+t[r],i[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this[r],i[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t[r],i[r++]=n&this.DM,n>>=this.DB;n+=t.s}i.s=0>n?-1:0,n>0?i[r++]=n:-1>n&&(i[r++]=this.DV+n),i.t=r,i.clamp()}function bnAdd(t){var i=nbi();return this.addTo(t,i),i}function bnSubtract(t){var i=nbi();return this.subTo(t,i),i}function bnMultiply(t){var i=nbi();return this.multiplyTo(t,i),i}function bnSquare(){var t=nbi();return this.squareTo(t),t}function bnDivide(t){var i=nbi();return this.divRemTo(t,i,null),i}function bnRemainder(t){var i=nbi();return this.divRemTo(t,null,i),i}function bnDivideAndRemainder(t){var i=nbi(),r=nbi();return this.divRemTo(t,i,r),new Array(i,r)}function bnpDMultiply(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(t,i){if(0!=t){for(;this.t<=i;)this[this.t++]=0;for(this[i]+=t;this[i]>=this.DV;)this[i]-=this.DV,++i>=this.t&&(this[this.t++]=0),++this[i]}}function NullExp(){}function nNop(t){return t}function nMulTo(t,i,r){t.multiplyTo(i,r)}function nSqrTo(t,i){t.squareTo(i)}function bnPow(t){return this.exp(t,new NullExp)}function bnpMultiplyLowerTo(t,i,r){var n=Math.min(this.t+t.t,i);for(r.s=0,r.t=n;n>0;)r[--n]=0;var e;for(e=r.t-this.t;e>n;++n)r[n+this.t]=this.am(0,t[n],r,n,0,this.t);for(e=Math.min(t.t,i);e>n;++n)this.am(0,t[n],r,n,0,i-n);r.clamp()}function bnpMultiplyUpperTo(t,i,r){--i;var n=r.t=this.t+t.t-i;for(r.s=0;--n>=0;)r[n]=0;for(n=Math.max(i-this.t,0);n<t.t;++n)r[this.t+n-i]=this.am(i-n,t[n],r,0,0,this.t+n-i);r.clamp(),r.drShiftTo(1,r)}function Barrett(t){this.r2=nbi(),this.q3=nbi(),BigInteger.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function barrettConvert(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var i=nbi();return t.copyTo(i),this.reduce(i),i}function barrettRevert(t){return t}function barrettReduce(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function barrettSqrTo(t,i){t.squareTo(i),this.reduce(i)}function barrettMulTo(t,i,r){t.multiplyTo(i,r),this.reduce(r)}function bnModPow(t,i){var r,n,e=t.bitLength(),o=nbv(1);if(0>=e)return o;r=18>e?1:48>e?3:144>e?4:768>e?5:6,n=8>e?new Classic(i):i.isEven()?new Barrett(i):new Montgomery(i);var s=new Array,h=3,p=r-1,u=(1<<r)-1;if(s[1]=n.convert(this),r>1){var f=nbi();for(n.sqrTo(s[1],f);u>=h;)s[h]=nbi(),n.mulTo(f,s[h-2],s[h]),h+=2}var a,b,g=t.t-1,l=!0,m=nbi();for(e=nbits(t[g])-1;g>=0;){for(e>=p?a=t[g]>>e-p&u:(a=(t[g]&(1<<e+1)-1)<<p-e,g>0&&(a|=t[g-1]>>this.DB+e-p)),h=r;0==(1&a);)a>>=1,--h;if((e-=h)<0&&(e+=this.DB,--g),l)s[a].copyTo(o),l=!1;else{for(;h>1;)n.sqrTo(o,m),n.sqrTo(m,o),h-=2;h>0?n.sqrTo(o,m):(b=o,o=m,m=b),n.mulTo(m,s[a],o)}for(;g>=0&&0==(t[g]&1<<e);)n.sqrTo(o,m),b=o,o=m,m=b,--e<0&&(e=this.DB-1,--g)}return n.revert(o)}function bnGCD(t){var i=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(i.compareTo(r)<0){var n=i;i=r,r=n}var e=i.getLowestSetBit(),o=r.getLowestSetBit();if(0>o)return i;for(o>e&&(o=e),o>0&&(i.rShiftTo(o,i),r.rShiftTo(o,r));i.signum()>0;)(e=i.getLowestSetBit())>0&&i.rShiftTo(e,i),(e=r.getLowestSetBit())>0&&r.rShiftTo(e,r),i.compareTo(r)>=0?(i.subTo(r,i),i.rShiftTo(1,i)):(r.subTo(i,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r}function bnpModInt(t){if(0>=t)return 0;var i=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(0==i)r=this[0]%t;else for(var n=this.t-1;n>=0;--n)r=(i*r+this[n])%t;return r}function bnModInverse(t){var i=t.isEven();if(this.isEven()&&i||0==t.signum())return BigInteger.ZERO;for(var r=t.clone(),n=this.clone(),e=nbv(1),o=nbv(0),s=nbv(0),h=nbv(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),i?(e.isEven()&&o.isEven()||(e.addTo(this,e),o.subTo(t,o)),e.rShiftTo(1,e)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;n.isEven();)n.rShiftTo(1,n),i?(s.isEven()&&h.isEven()||(s.addTo(this,s),h.subTo(t,h)),s.rShiftTo(1,s)):h.isEven()||h.subTo(t,h),h.rShiftTo(1,h);r.compareTo(n)>=0?(r.subTo(n,r),i&&e.subTo(s,e),o.subTo(h,o)):(n.subTo(r,n),i&&s.subTo(e,s),h.subTo(o,h))}return 0!=n.compareTo(BigInteger.ONE)?BigInteger.ZERO:h.compareTo(t)>=0?h.subtract(t):h.signum()<0?(h.addTo(t,h),h.signum()<0?h.add(t):h):h}function bnIsProbablePrime(t){var i,r=this.abs();if(1==r.t&&r[0]<=lowprimes[lowprimes.length-1]){for(i=0;i<lowprimes.length;++i)if(r[0]==lowprimes[i])return!0;return!1}if(r.isEven())return!1;for(i=1;i<lowprimes.length;){for(var n=lowprimes[i],e=i+1;e<lowprimes.length&&lplim>n;)n*=lowprimes[e++];for(n=r.modInt(n);e>i;)if(n%lowprimes[i++]==0)return!1}return r.millerRabin(t)}function bnpMillerRabin(t){var i=this.subtract(BigInteger.ONE),r=i.getLowestSetBit();if(0>=r)return!1;var n=i.shiftRight(r);t=t+1>>1,t>lowprimes.length&&(t=lowprimes.length);for(var e=nbi(),o=0;t>o;++o){e.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var s=e.modPow(n,this);if(0!=s.compareTo(BigInteger.ONE)&&0!=s.compareTo(i)){for(var h=1;h++<r&&0!=s.compareTo(i);)if(s=s.modPowInt(2,this),0==s.compareTo(BigInteger.ONE))return!1;if(0!=s.compareTo(i))return!1}}return!0}var dbits,canary=0xdeadbeefcafe,j_lm=15715070==(16777215&canary);j_lm&&"Microsoft Internet Explorer"==navigator.appName?(BigInteger.prototype.am=am2,dbits=30):j_lm&&"Netscape"!=navigator.appName?(BigInteger.prototype.am=am1,dbits=26):(BigInteger.prototype.am=am3,dbits=28),BigInteger.prototype.DB=dbits,BigInteger.prototype.DM=(1<<dbits)-1,BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP),BigInteger.prototype.F1=BI_FP-dbits,BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=new Array,rr,vv;for(rr="0".charCodeAt(0),vv=0;9>=vv;++vv)BI_RC[rr++]=vv;for(rr="a".charCodeAt(0),vv=10;36>vv;++vv)BI_RC[rr++]=vv;for(rr="A".charCodeAt(0),vv=10;36>vv;++vv)BI_RC[rr++]=vv;Classic.prototype.convert=cConvert,Classic.prototype.revert=cRevert,Classic.prototype.reduce=cReduce,Classic.prototype.mulTo=cMulTo,Classic.prototype.sqrTo=cSqrTo,Montgomery.prototype.convert=montConvert,Montgomery.prototype.revert=montRevert,Montgomery.prototype.reduce=montReduce,Montgomery.prototype.mulTo=montMulTo,Montgomery.prototype.sqrTo=montSqrTo,BigInteger.prototype.copyTo=bnpCopyTo,BigInteger.prototype.fromInt=bnpFromInt,BigInteger.prototype.fromString=bnpFromString,BigInteger.prototype.clamp=bnpClamp,BigInteger.prototype.dlShiftTo=bnpDLShiftTo,BigInteger.prototype.drShiftTo=bnpDRShiftTo,BigInteger.prototype.lShiftTo=bnpLShiftTo,BigInteger.prototype.rShiftTo=bnpRShiftTo,BigInteger.prototype.subTo=bnpSubTo,BigInteger.prototype.multiplyTo=bnpMultiplyTo,BigInteger.prototype.squareTo=bnpSquareTo,BigInteger.prototype.divRemTo=bnpDivRemTo,BigInteger.prototype.invDigit=bnpInvDigit,BigInteger.prototype.isEven=bnpIsEven,BigInteger.prototype.exp=bnpExp,BigInteger.prototype.toString=bnToString,BigInteger.prototype.negate=bnNegate,BigInteger.prototype.abs=bnAbs,BigInteger.prototype.compareTo=bnCompareTo,BigInteger.prototype.bitLength=bnBitLength,BigInteger.prototype.mod=bnMod,BigInteger.prototype.modPowInt=bnModPowInt,BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1),NullExp.prototype.convert=nNop,NullExp.prototype.revert=nNop,NullExp.prototype.mulTo=nMulTo,NullExp.prototype.sqrTo=nSqrTo,Barrett.prototype.convert=barrettConvert,Barrett.prototype.revert=barrettRevert,Barrett.prototype.reduce=barrettReduce,Barrett.prototype.mulTo=barrettMulTo,Barrett.prototype.sqrTo=barrettSqrTo;var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],lplim=(1<<26)/lowprimes[lowprimes.length-1];BigInteger.prototype.chunkSize=bnpChunkSize,BigInteger.prototype.toRadix=bnpToRadix,BigInteger.prototype.fromRadix=bnpFromRadix,BigInteger.prototype.fromNumber=bnpFromNumber,BigInteger.prototype.bitwiseTo=bnpBitwiseTo,BigInteger.prototype.changeBit=bnpChangeBit,BigInteger.prototype.addTo=bnpAddTo,BigInteger.prototype.dMultiply=bnpDMultiply,BigInteger.prototype.dAddOffset=bnpDAddOffset,BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo,BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo,BigInteger.prototype.modInt=bnpModInt,BigInteger.prototype.millerRabin=bnpMillerRabin,BigInteger.prototype.clone=bnClone,BigInteger.prototype.intValue=bnIntValue,BigInteger.prototype.byteValue=bnByteValue,BigInteger.prototype.shortValue=bnShortValue,BigInteger.prototype.signum=bnSigNum,BigInteger.prototype.toByteArray=bnToByteArray,BigInteger.prototype.equals=bnEquals,BigInteger.prototype.min=bnMin,BigInteger.prototype.max=bnMax,BigInteger.prototype.and=bnAnd,BigInteger.prototype.or=bnOr,BigInteger.prototype.xor=bnXor,BigInteger.prototype.andNot=bnAndNot,BigInteger.prototype.not=bnNot,BigInteger.prototype.shiftLeft=bnShiftLeft,BigInteger.prototype.shiftRight=bnShiftRight,BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit,BigInteger.prototype.bitCount=bnBitCount,BigInteger.prototype.testBit=bnTestBit,BigInteger.prototype.setBit=bnSetBit,BigInteger.prototype.clearBit=bnClearBit,BigInteger.prototype.flipBit=bnFlipBit,BigInteger.prototype.add=bnAdd,BigInteger.prototype.subtract=bnSubtract,BigInteger.prototype.multiply=bnMultiply,BigInteger.prototype.divide=bnDivide,BigInteger.prototype.remainder=bnRemainder,BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder,BigInteger.prototype.modPow=bnModPow,BigInteger.prototype.modInverse=bnModInverse,BigInteger.prototype.pow=bnPow,BigInteger.prototype.gcd=bnGCD,BigInteger.prototype.isProbablePrime=bnIsProbablePrime,BigInteger.prototype.square=bnSquare;


var converters=function(){var r,t={},n=[];for(r=0;9>=r;++r){var e=r.toString();t[e]=r,n.push(e)}for(r=10;15>=r;++r){var o=String.fromCharCode("a".charCodeAt(0)+r-10),a=String.fromCharCode("A".charCodeAt(0)+r-10);t[o]=r,t[a]=r,n.push(o)}return{byteArrayToHexString:function(r){for(var t="",e=0;e<r.length;++e)r[e]<0&&(r[e]+=256),t+=n[r[e]>>4]+n[15&r[e]];return t},stringToByteArray:function(r){r=unescape(encodeURIComponent(r));for(var t=new Array(r.length),n=0;n<r.length;++n)t[n]=r.charCodeAt(n);return t},hexStringToByteArray:function(r){var n=[],e=0;for(0!==r.length%2&&(n.push(t[r.charAt(0)]),++e);e<r.length-1;e+=2)n.push((t[r.charAt(e)]<<4)+t[r.charAt(e+1)]);return n},stringToHexString:function(r){return this.byteArrayToHexString(this.stringToByteArray(r))},hexStringToString:function(r){return this.byteArrayToString(this.hexStringToByteArray(r))},checkBytesToIntInput:function(r,t,n){var e=n||0;if(0>e)throw new Error("Start index should not be negative");if(r.length<e+t)throw new Error("Need at least "+t+" bytes to convert to an integer");return e},byteArrayToSignedShort:function(r,t){var n=this.checkBytesToIntInput(r,2,t),e=r[n];return e+=r[n+1]<<8},byteArrayToSignedInt32:function(r,t){var n=this.checkBytesToIntInput(r,4,t);return value=r[n],value+=r[n+1]<<8,value+=r[n+2]<<16,value+=r[n+3]<<24,value},byteArrayToBigInteger:function(r,t){for(var n,e,o=(this.checkBytesToIntInput(r,8,t),new BigInteger("0",10)),a=7;a>=0;a--)n=o.multiply(new BigInteger("256",10)),e=n.add(new BigInteger(r[t+a].toString(10),10)),o=e;return o},byteArrayToWordArray:function(r){for(var t=0,n=0,e=0,o=r.length,a=new Uint32Array((o/4|0)+(o%4==0?0:1));o-o%4>t;)a[n++]=r[t++]<<24|r[t++]<<16|r[t++]<<8|r[t++];o%4!=0&&(e=r[t++]<<24,o%4>1&&(e|=r[t++]<<16),o%4>2&&(e|=r[t++]<<8),a[n]=e);var i=new Object;return i.sigBytes=o,i.words=a,i},wordArrayToByteArray:function(r){var t=r.words.length;if(0==t)return new Array(0);var n,e,o=new Array(r.sigBytes),a=0;for(e=0;t-1>e;e++)n=r.words[e],o[a++]=n>>24,o[a++]=n>>16&255,o[a++]=n>>8&255,o[a++]=255&n;return n=r.words[t-1],o[a++]=n>>24,r.sigBytes%4==0&&(o[a++]=n>>16&255,o[a++]=n>>8&255,o[a++]=255&n),r.sigBytes%4>1&&(o[a++]=n>>16&255),r.sigBytes%4>2&&(o[a++]=n>>8&255),o},byteArrayToString:function(r,t,n){if(0==n)return"";if(t&&n){{this.checkBytesToIntInput(r,parseInt(n,10),parseInt(t,10))}r=r.slice(t,t+n)}return decodeURIComponent(escape(String.fromCharCode.apply(null,r)))},byteArrayToShortArray:function(r){var t,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;16>t;t++)n[t]=r[2*t]|r[2*t+1]<<8;return n},shortArrayToByteArray:function(r){var t,n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;16>t;t++)n[2*t]=255&r[t],n[2*t+1]=r[t]>>8;return n},shortArrayToHexString:function(r){for(var t="",e=0;e<r.length;e++)t+=n[r[e]>>4&15]+n[15&r[e]]+n[r[e]>>12&15]+n[r[e]>>8&15];return t},intToBytes_:function(r,t,n,e){var o=Math.floor(n/2),a=-1*(o+1);if(r!=Math.floor(r)||a>r||r>n)throw new Error(r+" is not a "+8*t+" bit integer");var i,u=[],y=r>=0&&o>=r?0:r>o&&n>=r?1:2;2==y&&(r=-1*r-1);for(var s=0;t>s;s++)i=2==y?255-r%256:r%256,e?u.unshift(i):u.push(i),1==y?r=Math.floor(r/256):r>>=8;return u},int32ToBytes:function(r,t){return converters.intToBytes_(r,4,4294967295,t)}}}();

var curve25519=function(){function r(r){r[31]&=127,r[31]|=64,r[0]&=248}function n(r,n){for(var f=0;32>f;f++)r[f]=n[f]}function f(r,n,f,o,a,u){f=0|f,a=0|a,u=0|u;for(var t=0,v=0;a>v;++v)t+=(255&n[v+f])+u*(255&o[v]),r[v+f]=255&t,t>>=8;return t}function o(r,n,o,a,u){a=0|a,u=0|u;for(var t=31,v=0,i=0;a>i;i++){var c=u*(255&o[i]);v+=f(r,r,i,n,t,c)+(255&r[i+t])+c*(255&n[t]),r[i+t]=255&v,v>>=8}return r[i+t]=v+(255&r[i+t])&255,v>>8}function a(r,n,o,a,u){o=0|o,u=0|u;var t=0,v=(255&a[u-1])<<8;for(u>1&&(v|=255&a[u-2]);o-->=u;){var i=t<<16|(255&n[o])<<8;o>0&&(i|=255&n[o-1]);var c=o-u+1;i/=v,t+=f(n,n,c,a,u,-i),r[c]=i+t&255,f(n,n,c,a,u,-t),t=255&n[o],n[o]=0}n[u-1]=255&t}function u(r,n){for(;0!==n--&&0===r[n];);return n+1}function t(r,n,f,t){var v,i,c,e=32;for(c=0;32>c;c++)r[c]=n[c]=0;if(r[0]=1,v=u(f,32),0===v)return n;for(var y=new Array(32);;){if(i=e-v+1,a(y,t,e,f,v),e=u(t,e),0===e)return r;if(o(n,r,y,i,-1),i=v-e+1,a(y,f,v,t,e),v=u(f,v),0===v)return n;o(r,n,y,i,-1)}}function v(r,n){for(var f=0;F>f;f+=2)r[f/2]=255&n[f]|(255&n[f+1])<<8}function i(r){return r[0]>Q-19&&(r[1]&r[3]&r[5]&r[7]&r[9])===P&&(r[2]&r[4]&r[6]&r[8])===Q||r[9]>P}function c(r,n){for(var f=0;G>f;++f)n[2*f]=255&r[f],n[2*f+1]=(65280&r[f])>>8}function e(){return new Uint16Array(G)}function y(r,n){for(var f=0;G>f;++f)r[f]=n[f]}function w(r,n){r[0]=n;for(var f=1;G>f;++f)r[f]=0}function A(r,n,f){var o,a=e(),u=e(),t=e(),v=e(),i=e();for(W(u,n),W(t,u),W(a,t),V(t,a,n),V(a,t,u),W(u,a),V(v,u,t),W(u,v),W(t,u),W(u,t),W(t,u),W(u,t),V(t,u,v),W(u,t),W(v,u),o=1;5>o;o++)W(u,v),W(v,u);for(V(u,v,t),W(v,u),W(i,v),o=1;10>o;o++)W(v,i),W(i,v);for(V(v,i,u),o=0;5>o;o++)W(u,v),W(v,u);for(V(u,v,t),W(t,u),W(v,t),o=1;25>o;o++)W(t,v),W(v,t);for(V(t,v,u),W(v,t),W(i,v),o=1;50>o;o++)W(v,i),W(i,v);for(V(v,i,t),o=0;25>o;o++)W(i,v),W(v,i);V(t,v,u),W(u,t),W(t,u),0!==f?V(r,n,t):(W(u,t),W(t,u),W(u,t),V(r,u,a))}function l(r){var n=i(r)||r[9]<0,f=1&r[0];return 4294967295&((n?1:0)^f)}function g(r,n){var f=e(),o=e(),a=e();R(o,n,n),A(f,o,1),W(r,f),V(a,o,r),S(a,a,L),V(o,f,a),V(r,n,o)}function k(r,n,f,o,a,u,t,v){var i,c=[];return c[0]=65535&(i=v*v),c[1]=65535&(i=(i/65536|0)+2*v*t),c[2]=65535&(i=(i/65536|0)+2*v*u+t*t),c[3]=65535&(i=(i/65536|0)+2*v*a+2*t*u),c[4]=65535&(i=(i/65536|0)+2*v*o+2*t*a+u*u),c[5]=65535&(i=(i/65536|0)+2*v*f+2*t*o+2*u*a),c[6]=65535&(i=(i/65536|0)+2*v*n+2*t*f+2*u*o+a*a),c[7]=65535&(i=(i/65536|0)+2*v*r+2*t*n+2*u*f+2*a*o),c[8]=65535&(i=(i/65536|0)+2*t*r+2*u*n+2*a*f+o*o),c[9]=65535&(i=(i/65536|0)+2*u*r+2*a*n+2*o*f),c[10]=65535&(i=(i/65536|0)+2*a*r+2*o*n+f*f),c[11]=65535&(i=(i/65536|0)+2*o*r+2*f*n),c[12]=65535&(i=(i/65536|0)+2*f*r+n*n),c[13]=65535&(i=(i/65536|0)+2*n*r),c[14]=65535&(i=(i/65536|0)+r*r),c[15]=i/65536|0,c}function s(r,n){var f,o=k(n[15],n[14],n[13],n[12],n[11],n[10],n[9],n[8]),a=k(n[7],n[6],n[5],n[4],n[3],n[2],n[1],n[0]),u=k(n[15]+n[7],n[14]+n[6],n[13]+n[5],n[12]+n[4],n[11]+n[3],n[10]+n[2],n[9]+n[1],n[8]+n[0]);r[0]=65535&(f=8388608+a[0]+38*(u[8]-o[8]-a[8]+o[0]-128)),r[1]=65535&(f=8388480+(f/65536|0)+a[1]+38*(u[9]-o[9]-a[9]+o[1])),r[2]=65535&(f=8388480+(f/65536|0)+a[2]+38*(u[10]-o[10]-a[10]+o[2])),r[3]=65535&(f=8388480+(f/65536|0)+a[3]+38*(u[11]-o[11]-a[11]+o[3])),r[4]=65535&(f=8388480+(f/65536|0)+a[4]+38*(u[12]-o[12]-a[12]+o[4])),r[5]=65535&(f=8388480+(f/65536|0)+a[5]+38*(u[13]-o[13]-a[13]+o[5])),r[6]=65535&(f=8388480+(f/65536|0)+a[6]+38*(u[14]-o[14]-a[14]+o[6])),r[7]=65535&(f=8388480+(f/65536|0)+a[7]+38*(u[15]-o[15]-a[15]+o[7])),r[8]=65535&(f=8388480+(f/65536|0)+a[8]+u[0]-o[0]-a[0]+38*o[8]),r[9]=65535&(f=8388480+(f/65536|0)+a[9]+u[1]-o[1]-a[1]+38*o[9]),r[10]=65535&(f=8388480+(f/65536|0)+a[10]+u[2]-o[2]-a[2]+38*o[10]),r[11]=65535&(f=8388480+(f/65536|0)+a[11]+u[3]-o[3]-a[3]+38*o[11]),r[12]=65535&(f=8388480+(f/65536|0)+a[12]+u[4]-o[4]-a[4]+38*o[12]),r[13]=65535&(f=8388480+(f/65536|0)+a[13]+u[5]-o[5]-a[5]+38*o[13]),r[14]=65535&(f=8388480+(f/65536|0)+a[14]+u[6]-o[6]-a[6]+38*o[14]);var t=8388480+(f/65536|0)+a[15]+u[7]-o[7]-a[7]+38*o[15];U(r,t)}function d(r,n,f,o,a,u,t,v,i,c,e,y,w,A,l,g){var k,s=[];return s[0]=65535&(k=v*g),s[1]=65535&(k=(k/65536|0)+v*l+t*g),s[2]=65535&(k=(k/65536|0)+v*A+t*l+u*g),s[3]=65535&(k=(k/65536|0)+v*w+t*A+u*l+a*g),s[4]=65535&(k=(k/65536|0)+v*y+t*w+u*A+a*l+o*g),s[5]=65535&(k=(k/65536|0)+v*e+t*y+u*w+a*A+o*l+f*g),s[6]=65535&(k=(k/65536|0)+v*c+t*e+u*y+a*w+o*A+f*l+n*g),s[7]=65535&(k=(k/65536|0)+v*i+t*c+u*e+a*y+o*w+f*A+n*l+r*g),s[8]=65535&(k=(k/65536|0)+t*i+u*c+a*e+o*y+f*w+n*A+r*l),s[9]=65535&(k=(k/65536|0)+u*i+a*c+o*e+f*y+n*w+r*A),s[10]=65535&(k=(k/65536|0)+a*i+o*c+f*e+n*y+r*w),s[11]=65535&(k=(k/65536|0)+o*i+f*c+n*e+r*y),s[12]=65535&(k=(k/65536|0)+f*i+n*c+r*e),s[13]=65535&(k=(k/65536|0)+n*i+r*c),s[14]=65535&(k=(k/65536|0)+r*i),s[15]=k/65536|0,s}function p(r,n,f){var o,a=d(n[15],n[14],n[13],n[12],n[11],n[10],n[9],n[8],f[15],f[14],f[13],f[12],f[11],f[10],f[9],f[8]),u=d(n[7],n[6],n[5],n[4],n[3],n[2],n[1],n[0],f[7],f[6],f[5],f[4],f[3],f[2],f[1],f[0]),t=d(n[15]+n[7],n[14]+n[6],n[13]+n[5],n[12]+n[4],n[11]+n[3],n[10]+n[2],n[9]+n[1],n[8]+n[0],f[15]+f[7],f[14]+f[6],f[13]+f[5],f[12]+f[4],f[11]+f[3],f[10]+f[2],f[9]+f[1],f[8]+f[0]);r[0]=65535&(o=8388608+u[0]+38*(t[8]-a[8]-u[8]+a[0]-128)),r[1]=65535&(o=8388480+(o/65536|0)+u[1]+38*(t[9]-a[9]-u[9]+a[1])),r[2]=65535&(o=8388480+(o/65536|0)+u[2]+38*(t[10]-a[10]-u[10]+a[2])),r[3]=65535&(o=8388480+(o/65536|0)+u[3]+38*(t[11]-a[11]-u[11]+a[3])),r[4]=65535&(o=8388480+(o/65536|0)+u[4]+38*(t[12]-a[12]-u[12]+a[4])),r[5]=65535&(o=8388480+(o/65536|0)+u[5]+38*(t[13]-a[13]-u[13]+a[5])),r[6]=65535&(o=8388480+(o/65536|0)+u[6]+38*(t[14]-a[14]-u[14]+a[6])),r[7]=65535&(o=8388480+(o/65536|0)+u[7]+38*(t[15]-a[15]-u[15]+a[7])),r[8]=65535&(o=8388480+(o/65536|0)+u[8]+t[0]-a[0]-u[0]+38*a[8]),r[9]=65535&(o=8388480+(o/65536|0)+u[9]+t[1]-a[1]-u[1]+38*a[9]),r[10]=65535&(o=8388480+(o/65536|0)+u[10]+t[2]-a[2]-u[2]+38*a[10]),r[11]=65535&(o=8388480+(o/65536|0)+u[11]+t[3]-a[3]-u[3]+38*a[11]),r[12]=65535&(o=8388480+(o/65536|0)+u[12]+t[4]-a[4]-u[4]+38*a[12]),r[13]=65535&(o=8388480+(o/65536|0)+u[13]+t[5]-a[5]-u[5]+38*a[13]),r[14]=65535&(o=8388480+(o/65536|0)+u[14]+t[6]-a[6]-u[6]+38*a[14]);var v=8388480+(o/65536|0)+u[15]+t[7]-a[7]-u[7]+38*a[15];U(r,v)}function U(r,n){var f=n;r[15]=32767&f,f=19*(f/32768|0);for(var o=0;14>=o;++o)r[o]=65535&(f+=r[o]),f=f/65536|0;r[15]+=f}function b(r,n,f){var o;r[0]=65535&(o=19*((n[15]/32768|0)+(f[15]/32768|0))+n[0]+f[0]);for(var a=1;14>=a;++a)r[a]=65535&(o=(o/65536|0)+n[a]+f[a]);r[15]=(o/65536|0)+(32767&n[15])+(32767&f[15])}function h(r,n,f){var o;r[0]=65535&(o=524288+19*((n[15]/32768|0)-(f[15]/32768|0)-1)+n[0]-f[0]);for(var a=1;14>=a;++a)r[a]=65535&(o=(o/65536|0)+524280+n[a]-f[a]);r[15]=(o/65536|0)+32760+(32767&n[15])-(32767&f[15])}function j(r,n,f){var o;r[0]=65535&(o=n[0]*f);for(var a=1;14>=a;++a)r[a]=65535&(o=(o/65536|0)+n[a]*f);var u=(o/65536|0)+n[15]*f;U(r,u)}function m(r,n,f,o){R(r,f,o),S(n,f,o)}function q(r,n,f,o,a,u,t){V(a,n,f),V(u,r,o),R(r,a,u),S(n,a,u),W(a,r),W(r,n),V(u,r,t)}function x(r,n,f,o,a,u){W(r,f),W(n,o),V(a,r,n),S(n,r,n),T(u,n,121665),R(r,r,u),V(u,r,n)}function z(r,n,f){W(r,f),T(n,f,486662),R(r,r,n),R(r,r,L),V(n,r,f)}function B(r,o,a,u){var i,g,k=e(),s=e(),d=e(),p=e(),U=e(),b=[e(),e()],h=[e(),e()];for(null!==u?v(k,u):w(k,9),w(b[0],1),w(h[0],0),y(b[1],k),w(h[1],1),i=32;0!==i--;)for(g=8;0!==g--;){var j=(255&a[i])>>g&1,B=~(255&a[i])>>g&1,C=b[B],D=h[B],E=b[j],F=h[j];m(s,d,C,D),m(p,U,E,F),q(s,d,p,U,C,D,k),x(s,d,p,U,E,F)}if(A(s,h[0],0),V(k,b[0],s),c(k,r),null!==o){z(d,s,k),A(p,h[1],0),V(d,b[1],p),R(d,d,k),R(d,d,N),S(k,k,M),W(p,k),V(k,d,p),S(k,k,s),S(k,k,O),V(s,k,K),0!==l(s)?n(o,a):f(o,I,0,a,32,-1);var G=new Array(32),J=new Array(64),L=new Array(64);n(G,H),n(o,t(J,L,o,G)),0!==(128&o[31])&&f(o,o,0,H,32,1)}}function C(r,u,t){var v,i,c=new Array(32),e=new Array(32),y=new Array(64),w=new Array(64);n(c,r),n(e,u);var A=new Array(32);a(A,c,32,H,32),a(A,e,32,H,32);var l=new Array(32);for(f(l,e,0,c,32,-1),f(l,l,0,H,32,1),o(y,l,t,32,1),a(w,y,64,H,32),v=0,i=0;32>i;i++)v|=l[i]=y[i];return 0!==v?l:void 0}function D(r,n,f){var o,a,u,t=new Array(32),i=[e(),e()],k=[e(),e()],s=[e(),e(),e()],d=[e(),e(),e()],p=[e(),e(),e()],U=[e(),e(),e()],b=0,h=0,j=0,B=0;for(w(i[0],9),v(i[1],f),z(p[0],U[0],i[1]),g(p[0],U[0]),a=l(p[0]),R(U[0],U[0],O),V(U[1],J,p[0]),S(p[a],U[0],U[1]),R(p[1-a],U[0],U[1]),y(U[0],i[1]),S(U[0],U[0],M),W(U[1],U[0]),A(U[0],U[1],0),V(k[0],p[0],U[0]),S(k[0],k[0],i[1]),S(k[0],k[0],N),V(k[1],p[1],U[0]),S(k[1],k[1],i[1]),S(k[1],k[1],N),T(k[0],k[0],1),T(k[1],k[1],1),o=0;32>o;o++)b=b>>8^255&r[o]^(255&r[o])<<1,h=h>>8^255&n[o]^(255&n[o])<<1,B=~(b^h),j=B&(128&j)>>7^b,j^=B&(1&j)<<1,j^=B&(2&j)<<1,j^=B&(4&j)<<1,j^=B&(8&j)<<1,j^=B&(16&j)<<1,j^=B&(32&j)<<1,j^=B&(64&j)<<1,t[o]=255&j;for(j=(B&(128&j)<<1^b)>>8,w(s[0],1),y(s[1],i[j]),y(s[2],k[0]),w(d[0],0),w(d[1],1),w(d[2],1),b=0,h=0,o=32;0!==o--;)for(b=b<<8|255&r[o],h=h<<8|255&n[o],j=j<<8|255&t[o],a=8;0!==a--;)m(p[0],U[0],s[0],d[0]),m(p[1],U[1],s[1],d[1]),m(p[2],U[2],s[2],d[2]),u=((b^b>>1)>>a&1)+((h^h>>1)>>a&1),x(s[2],d[2],p[u],U[u],s[0],d[0]),u=j>>a&2^(j>>a&1)<<1,q(p[1],U[1],p[u],U[u],s[1],d[1],i[j>>a&1]),q(p[2],U[2],p[0],U[0],s[2],d[2],k[((b^h)>>a&2)>>1]);u=(1&b)+(1&h),A(p[0],d[u],0),V(p[1],s[u],p[0]);var C=[];return c(p[1],C),C}function E(n){var f=[],o=[];return n=n||[],r(n),B(f,o,n,null),{p:f,s:o,k:n}}var F=32,G=16,H=[237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16],I=[104,159,174,231,210,24,147,192,178,230,188,23,245,206,247,166,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128],J=[22587,610,29883,44076,15515,9479,25859,56197,23910,4462,17831,16322,62102,36542,52412,16035],K=[5744,16384,61977,54121,8776,18501,26522,34893,23833,5823,55924,58749,24147,14085,13606,6080],L=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],M=[9,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],N=[27919,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0],O=[33224,601,0,0,0,0,0,0,0,0,0,0,0,0,0,0],P=33554431,Q=67108863,R=b,S=h,T=j,V=p,W=s;return{sign:C,verify:D,keygen:E}}();

function string_to_array(_){for(var H=_.length,A=new Array(H),r=0;H>r;r++)A[r]=_.charCodeAt(r);return A}function array_to_hex_string(_){for(var H="",A=0;A<_.length;A++)H+=SHA256_hexchars[_[A]>>4]+SHA256_hexchars[15&_[A]];return H}function SHA256_init(){SHA256_H=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),SHA256_buf=new Array,SHA256_len=0}function SHA256_write(_){SHA256_buf=SHA256_buf.concat("string"==typeof _?string_to_array(_):_);for(var H=0;H+64<=SHA256_buf.length;H+=64)SHA256_Hash_Byte_Block(SHA256_H,SHA256_buf.slice(H,H+64));SHA256_buf=SHA256_buf.slice(H),SHA256_len+=_.length}function SHA256_finalize(){if(SHA256_buf[SHA256_buf.length]=128,SHA256_buf.length>56){for(var _=SHA256_buf.length;64>_;_++)SHA256_buf[_]=0;SHA256_Hash_Byte_Block(SHA256_H,SHA256_buf),SHA256_buf.length=0}for(var _=SHA256_buf.length;59>_;_++)SHA256_buf[_]=0;SHA256_buf[59]=SHA256_len>>>29&255,SHA256_buf[60]=SHA256_len>>>21&255,SHA256_buf[61]=SHA256_len>>>13&255,SHA256_buf[62]=SHA256_len>>>5&255,SHA256_buf[63]=SHA256_len<<3&255,SHA256_Hash_Byte_Block(SHA256_H,SHA256_buf);for(var H=new Array(32),_=0;8>_;_++)H[4*_+0]=SHA256_H[_]>>>24,H[4*_+1]=SHA256_H[_]>>16&255,H[4*_+2]=SHA256_H[_]>>8&255,H[4*_+3]=255&SHA256_H[_];return delete SHA256_H,delete SHA256_buf,delete SHA256_len,H}function SHA256_hash(_,H){var A;return SHA256_init(),SHA256_write(_),A=SHA256_finalize(),H?A:array_to_hex_string(A)}function HMAC_SHA256_init(_){HMAC_SHA256_key="string"==typeof _?string_to_array(_):(new Array).concat(_),HMAC_SHA256_key.length>64&&(SHA256_init(),SHA256_write(HMAC_SHA256_key),HMAC_SHA256_key=SHA256_finalize());for(var H=HMAC_SHA256_key.length;64>H;H++)HMAC_SHA256_key[H]=0;for(var H=0;64>H;H++)HMAC_SHA256_key[H]^=54;SHA256_init(),SHA256_write(HMAC_SHA256_key)}function HMAC_SHA256_write(_){SHA256_write(_)}function HMAC_SHA256_finalize(){for(var _=SHA256_finalize(),H=0;64>H;H++)HMAC_SHA256_key[H]^=106;SHA256_init(),SHA256_write(HMAC_SHA256_key),SHA256_write(_);for(var H=0;64>H;H++)HMAC_SHA256_key[H]=0;return delete HMAC_SHA256_key,SHA256_finalize()}function HMAC_SHA256_MAC(_,H){var A;return HMAC_SHA256_init(_),HMAC_SHA256_write(H),A=HMAC_SHA256_finalize(),array_to_hex_string(A)}function SHA256_sigma0(_){return(_>>>7|_<<25)^(_>>>18|_<<14)^_>>>3}function SHA256_sigma1(_){return(_>>>17|_<<15)^(_>>>19|_<<13)^_>>>10}function SHA256_Sigma0(_){return(_>>>2|_<<30)^(_>>>13|_<<19)^(_>>>22|_<<10)}function SHA256_Sigma1(_){return(_>>>6|_<<26)^(_>>>11|_<<21)^(_>>>25|_<<7)}function SHA256_Ch(_,H,A){return A^_&(H^A)}function SHA256_Maj(_,H,A){return _&H^A&(_^H)}function SHA256_Hash_Word_Block(_,H){for(var A=16;64>A;A++)H[A]=SHA256_sigma1(H[A-2])+H[A-7]+SHA256_sigma0(H[A-15])+H[A-16]&4294967295;for(var r=(new Array).concat(_),A=0;64>A;A++){var S=r[7]+SHA256_Sigma1(r[4])+SHA256_Ch(r[4],r[5],r[6])+SHA256_K[A]+H[A],n=SHA256_Sigma0(r[0])+SHA256_Maj(r[0],r[1],r[2]);r.pop(),r.unshift(S+n&4294967295),r[4]=r[4]+S&4294967295}for(var A=0;8>A;A++)_[A]=_[A]+r[A]&4294967295}function SHA256_Hash_Byte_Block(_,H){for(var A=new Array(16),r=0;16>r;r++)A[r]=H[4*r+0]<<24|H[4*r+1]<<16|H[4*r+2]<<8|H[4*r+3];SHA256_Hash_Word_Block(_,A)}var SHA256_buf=new Array,SHA256_len=0,SHA256_H=new Array;SHA256_hexchars=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"),SHA256_K=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298);

function NxtAddress(){function r(r){return v[31-c[r]]}function t(r,t){if(0==r||0==t)return 0;var e=(c[r]+c[t])%31;return v[e]}function e(r,e){for(var f=0,n=0;e>n;n++)f^=t(r[n],h[e-n]);return f}function f(r){for(var e=[],f=1;31>=f;f++){for(var n=0,i=0;5>i;i++)n^=t(v[i*f%31],r[i]);if(0==n){var o=31-f;if(o>12&&27>o)return[];e[e.length]=o}}return e}function n(){for(var n=0,i=[0,0,0,0,0],o=[],a=0,s=[1,0,0,0,0],c=0;4>c;c++){var d=e(s,c+1);if(0!=d){a=0;for(var g=0;5>g;g++)o[g]=s[g]^t(d,i[g]),o[g]&&(a=g);if(c>=2*n)for(n=c+1-n,g=0;5>g;g++)i[g]=t(s[g],r(d));s=o.slice()}i.unshift(0)}var l=f(s),p=l.length;if(1>p||p>2)return!1;if(a!=p)return!1;for(var C=[0,0,0,0,0],g=0;4>g;g++){for(var o=0,A=0;g>A;A++)o^=t(h[g+1-A],s[A]);C[g]=o}for(c=0;p>c;c++){var o=0,b=l[c],k=31-b;for(g=0;4>g;g++)o^=t(C[g],v[k*g%31]);if(o){var _=t(s[1],1)^t(s[3],v[2*k%31]);if(0==_)return!1;b>12&&(b-=14),u[b]^=t(o,r(_))}}return!0}function i(){for(var r=[0,0,0,0],e=12;e>=0;e--){var f=u[e]^r[3];r[3]=r[2]^t(30,f),r[2]=r[1]^t(6,f),r[1]=r[0]^t(9,f),r[0]=t(17,f)}u[13]=r[0],u[14]=r[1],u[15]=r[2],u[16]=r[3]}function o(){for(var r=0;17>r;r++)u[r]=1}function a(r,t,e){"undefined"==typeof t&&(t=17),"undefined"==typeof e&&(e=-1);for(var f=0,n=0;t>f;f++)f!=e&&(u[d[n++]]=r[f])}function s(r){var t=[],e=[],f=0,n=r.length;if(20==n&&"1"!=r.charAt(0))return!1;for(var o=0;n>o;o++)t[o]=r.charCodeAt(o)-"0".charCodeAt(0);do{var a=0,s=0;for(o=0;n>o;o++)a=10*a+t[o],a>=32?(t[s++]=a>>5,a&=31):s>0&&(t[s++]=0);n=s,e[f++]=a}while(s);for(o=0;13>o;o++)u[o]=--f>=0?e[o]:0;return i(),!0}var u=[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],h=[0,0,0,0,0],v=[1,2,4,8,16,5,10,20,13,26,17,7,14,28,29,31,27,19,3,6,12,24,21,15,30,25,23,11,22,9,18,1],c=[0,0,1,18,2,5,19,11,3,29,6,27,20,8,12,23,4,10,30,17,7,22,28,26,21,25,9,16,13,14,24,15],d=[3,2,1,0,7,6,5,4,13,14,15,16,12,8,9,10,11],g="23456789ABCDEFGHJKLMNPQRSTUVWXYZ";this.guess=[],this.add_guess=function(){var r=this.toString(),t=this.guess.length;if(!(t>2)){for(var e=0;t>e;e++)if(this.guess[e]==r)return;this.guess[t]=r}},this.ok=function(){for(var r=0,e=1;5>e;e++){for(var f=0,n=0;31>f;f++)if(!(f>12&&27>f)){var i=f;f>26&&(i-=14),n^=t(u[i],v[e*f%31])}r|=n,h[e]=n}return 0==r},this.toString=function(){for(var r="NXT-",t=0;17>t;t++)r+=g[u[d[t]]],3==(3&t)&&13>t&&(r+="-");return r},this.account_id=function(){for(var r="",t=[],e=13,f=0;13>f;f++)t[f]=u[12-f];do{var n=0,i=0;for(f=0;e>f;f++)n=32*n+t[f],n>=10?(t[i++]=Math.floor(n/10),n%=10):i>0&&(t[i++]=0);e=i,r+=String.fromCharCode(n+"0".charCodeAt(0))}while(i);return r.split("").reverse().join("")},this.set=function(r,t){"undefined"==typeof t&&(t=!0);var e=0;if(this.guess=[],o(),r=String(r),r=r.replace(/(^\s+)|(\s+$)/g,"").toUpperCase(),0==r.indexOf("NXT-")&&(r=r.substr(4)),r.match(/^\d{1,20}$/g)){if(t)return s(r)}else for(var f=[],i=0;i<r.length;i++){var u=g.indexOf(r[i]);if(u>=0&&(f[e++]=u,e>18))return!1}if(16==e)for(var i=16;i>=0;i--){for(var h=0;32>h;h++)f[i]=h,a(f),this.ok()&&this.add_guess();if(i>0){var v=f[i-1];f[i-1]=f[i],f[i]=v}}if(18==e)for(var i=0;18>i;i++)a(f,18,i),this.ok()&&this.add_guess();if(17==e){if(a(f),this.ok())return!0;n()&&this.ok()&&this.add_guess()}return o(),!1},this.format_guess=function(r,t){var e="",f=[];r=r.toUpperCase(),t=t.toUpperCase();for(var n=0;n<r.length;){for(var i=0,o=1;o<r.length;o++){var a=t.indexOf(r.substr(n,o));if(-1==a)break;Math.abs(a-n)<3&&(i=o)}i?(f[f.length]={s:n,e:n+i},n+=i):n++}if(0==f.length)return r;for(var n=0,o=0;n<r.length;n++){if(n>=f[o].e)for(var s;o<f.length-1&&(s=f[o++].s,!(n<f[o].e||f[o].s>=s)););e+=n>=f[o].s&&n<f[o].e?r.charAt(n):'<b style="color:red">'+r.charAt(n)+"</b>"}return e}}

var CryptoJS=CryptoJS||function(t,e){var r={},i=r.lib={},n=function(){},s=i.Base={extend:function(t){n.prototype=this;var e=new n;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),e.init.prototype=e,e.$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},o=i.WordArray=s.extend({init:function(t,r){t=this.words=t||[],this.sigBytes=r!=e?r:4*t.length},toString:function(t){return(t||a).stringify(this)},concat:function(t){var e=this.words,r=t.words,i=this.sigBytes;if(t=t.sigBytes,this.clamp(),i%4)for(var n=0;t>n;n++)e[i+n>>>2]|=(r[n>>>2]>>>24-8*(n%4)&255)<<24-8*((i+n)%4);else if(65535<r.length)for(n=0;t>n;n+=4)e[i+n>>>2]=r[n>>>2];else e.push.apply(e,r);return this.sigBytes+=t,this},clamp:function(){var e=this.words,r=this.sigBytes;e[r>>>2]&=4294967295<<32-8*(r%4),e.length=t.ceil(r/4)},clone:function(){var t=s.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var r=[],i=0;e>i;i+=4)r.push(4294967296*t.random()|0);return new o.init(r,e)}}),c=r.enc={},a=c.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var r=[],i=0;t>i;i++){var n=e[i>>>2]>>>24-8*(i%4)&255;r.push((n>>>4).toString(16)),r.push((15&n).toString(16))}return r.join("")},parse:function(t){for(var e=t.length,r=[],i=0;e>i;i+=2)r[i>>>3]|=parseInt(t.substr(i,2),16)<<24-4*(i%8);return new o.init(r,e/2)}},f=c.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var r=[],i=0;t>i;i++)r.push(String.fromCharCode(e[i>>>2]>>>24-8*(i%4)&255));return r.join("")},parse:function(t){for(var e=t.length,r=[],i=0;e>i;i++)r[i>>>2]|=(255&t.charCodeAt(i))<<24-8*(i%4);return new o.init(r,e)}},h=c.Utf8={stringify:function(t){try{return decodeURIComponent(escape(f.stringify(t)))}catch(e){throw Error("Malformed UTF-8 data")}},parse:function(t){return f.parse(unescape(encodeURIComponent(t)))}},u=i.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=h.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var r=this._data,i=r.words,n=r.sigBytes,s=this.blockSize,c=n/(4*s),c=e?t.ceil(c):t.max((0|c)-this._minBufferSize,0);if(e=c*s,n=t.min(4*e,n),e){for(var a=0;e>a;a+=s)this._doProcessBlock(i,a);a=i.splice(0,e),r.sigBytes-=n}return new o.init(a,n)},clone:function(){var t=s.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});i.Hasher=u.extend({cfg:s.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){u.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,r){return new t.init(r).finalize(e)}},_createHmacHelper:function(t){return function(e,r){return new p.HMAC.init(t,r).finalize(e)}}});var p=r.algo={};return r}(Math);!function(){var t=CryptoJS,e=t.lib.WordArray;t.enc.Base64={stringify:function(t){var e=t.words,r=t.sigBytes,i=this._map;t.clamp(),t=[];for(var n=0;r>n;n+=3)for(var s=(e[n>>>2]>>>24-8*(n%4)&255)<<16|(e[n+1>>>2]>>>24-8*((n+1)%4)&255)<<8|e[n+2>>>2]>>>24-8*((n+2)%4)&255,o=0;4>o&&r>n+.75*o;o++)t.push(i.charAt(s>>>6*(3-o)&63));if(e=i.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var r=t.length,i=this._map,n=i.charAt(64);n&&(n=t.indexOf(n),-1!=n&&(r=n));for(var n=[],s=0,o=0;r>o;o++)if(o%4){var c=i.indexOf(t.charAt(o-1))<<2*(o%4),a=i.indexOf(t.charAt(o))>>>6-2*(o%4);n[s>>>2]|=(c|a)<<24-8*(s%4),s++}return e.create(n,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(t){function e(t,e,r,i,n,s,o){return t=t+(e&r|~e&i)+n+o,(t<<s|t>>>32-s)+e}function r(t,e,r,i,n,s,o){return t=t+(e&i|r&~i)+n+o,(t<<s|t>>>32-s)+e}function i(t,e,r,i,n,s,o){return t=t+(e^r^i)+n+o,(t<<s|t>>>32-s)+e}function n(t,e,r,i,n,s,o){return t=t+(r^(e|~i))+n+o,(t<<s|t>>>32-s)+e}for(var s=CryptoJS,o=s.lib,c=o.WordArray,a=o.Hasher,o=s.algo,f=[],h=0;64>h;h++)f[h]=4294967296*t.abs(t.sin(h+1))|0;o=o.MD5=a.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,s){for(var o=0;16>o;o++){var c=s+o,a=t[c];t[c]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}var o=this._hash.words,c=t[s+0],a=t[s+1],h=t[s+2],u=t[s+3],p=t[s+4],d=t[s+5],l=t[s+6],y=t[s+7],_=t[s+8],v=t[s+9],g=t[s+10],B=t[s+11],m=t[s+12],x=t[s+13],S=t[s+14],k=t[s+15],z=o[0],C=o[1],w=o[2],D=o[3],z=e(z,C,w,D,c,7,f[0]),D=e(D,z,C,w,a,12,f[1]),w=e(w,D,z,C,h,17,f[2]),C=e(C,w,D,z,u,22,f[3]),z=e(z,C,w,D,p,7,f[4]),D=e(D,z,C,w,d,12,f[5]),w=e(w,D,z,C,l,17,f[6]),C=e(C,w,D,z,y,22,f[7]),z=e(z,C,w,D,_,7,f[8]),D=e(D,z,C,w,v,12,f[9]),w=e(w,D,z,C,g,17,f[10]),C=e(C,w,D,z,B,22,f[11]),z=e(z,C,w,D,m,7,f[12]),D=e(D,z,C,w,x,12,f[13]),w=e(w,D,z,C,S,17,f[14]),C=e(C,w,D,z,k,22,f[15]),z=r(z,C,w,D,a,5,f[16]),D=r(D,z,C,w,l,9,f[17]),w=r(w,D,z,C,B,14,f[18]),C=r(C,w,D,z,c,20,f[19]),z=r(z,C,w,D,d,5,f[20]),D=r(D,z,C,w,g,9,f[21]),w=r(w,D,z,C,k,14,f[22]),C=r(C,w,D,z,p,20,f[23]),z=r(z,C,w,D,v,5,f[24]),D=r(D,z,C,w,S,9,f[25]),w=r(w,D,z,C,u,14,f[26]),C=r(C,w,D,z,_,20,f[27]),z=r(z,C,w,D,x,5,f[28]),D=r(D,z,C,w,h,9,f[29]),w=r(w,D,z,C,y,14,f[30]),C=r(C,w,D,z,m,20,f[31]),z=i(z,C,w,D,d,4,f[32]),D=i(D,z,C,w,_,11,f[33]),w=i(w,D,z,C,B,16,f[34]),C=i(C,w,D,z,S,23,f[35]),z=i(z,C,w,D,a,4,f[36]),D=i(D,z,C,w,p,11,f[37]),w=i(w,D,z,C,y,16,f[38]),C=i(C,w,D,z,g,23,f[39]),z=i(z,C,w,D,x,4,f[40]),D=i(D,z,C,w,c,11,f[41]),w=i(w,D,z,C,u,16,f[42]),C=i(C,w,D,z,l,23,f[43]),z=i(z,C,w,D,v,4,f[44]),D=i(D,z,C,w,m,11,f[45]),w=i(w,D,z,C,k,16,f[46]),C=i(C,w,D,z,h,23,f[47]),z=n(z,C,w,D,c,6,f[48]),D=n(D,z,C,w,y,10,f[49]),w=n(w,D,z,C,S,15,f[50]),C=n(C,w,D,z,d,21,f[51]),z=n(z,C,w,D,m,6,f[52]),D=n(D,z,C,w,u,10,f[53]),w=n(w,D,z,C,g,15,f[54]),C=n(C,w,D,z,a,21,f[55]),z=n(z,C,w,D,_,6,f[56]),D=n(D,z,C,w,k,10,f[57]),w=n(w,D,z,C,l,15,f[58]),C=n(C,w,D,z,x,21,f[59]),z=n(z,C,w,D,p,6,f[60]),D=n(D,z,C,w,B,10,f[61]),w=n(w,D,z,C,h,15,f[62]),C=n(C,w,D,z,v,21,f[63]);o[0]=o[0]+z|0,o[1]=o[1]+C|0,o[2]=o[2]+w|0,o[3]=o[3]+D|0},_doFinalize:function(){var e=this._data,r=e.words,i=8*this._nDataBytes,n=8*e.sigBytes;r[n>>>5]|=128<<24-n%32;var s=t.floor(i/4294967296);for(r[(n+64>>>9<<4)+15]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),r[(n+64>>>9<<4)+14]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),e.sigBytes=4*(r.length+1),this._process(),e=this._hash,r=e.words,i=0;4>i;i++)n=r[i],r[i]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8);return e},clone:function(){var t=a.clone.call(this);return t._hash=this._hash.clone(),t}}),s.MD5=a._createHelper(o),s.HmacMD5=a._createHmacHelper(o)}(Math),function(){var t=CryptoJS,e=t.lib,r=e.Base,i=e.WordArray,e=t.algo,n=e.EvpKDF=r.extend({cfg:r.extend({keySize:4,hasher:e.MD5,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){for(var r=this.cfg,n=r.hasher.create(),s=i.create(),o=s.words,c=r.keySize,r=r.iterations;o.length<c;){a&&n.update(a);var a=n.update(t).finalize(e);n.reset();for(var f=1;r>f;f++)a=n.finalize(a),n.reset();s.concat(a)}return s.sigBytes=4*c,s}});t.EvpKDF=function(t,e,r){return n.create(r).compute(t,e)}}(),CryptoJS.lib.Cipher||function(t){var e=CryptoJS,r=e.lib,i=r.Base,n=r.WordArray,s=r.BufferedBlockAlgorithm,o=e.enc.Base64,c=e.algo.EvpKDF,a=r.Cipher=s.extend({cfg:i.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,r){this.cfg=this.cfg.extend(r),this._xformMode=t,this._key=e,this.reset()},reset:function(){s.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(t){return{encrypt:function(e,r,i){return("string"==typeof r?l:d).encrypt(t,e,r,i)},decrypt:function(e,r,i){return("string"==typeof r?l:d).decrypt(t,e,r,i)}}}});r.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var f=e.mode={},h=function(e,r,i){var n=this._iv;n?this._iv=t:n=this._prevBlock;for(var s=0;i>s;s++)e[r+s]^=n[s]},u=(r.BlockCipherMode=i.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}})).extend();u.Encryptor=u.extend({processBlock:function(t,e){var r=this._cipher,i=r.blockSize;h.call(this,t,e,i),r.encryptBlock(t,e),this._prevBlock=t.slice(e,e+i)}}),u.Decryptor=u.extend({processBlock:function(t,e){var r=this._cipher,i=r.blockSize,n=t.slice(e,e+i);r.decryptBlock(t,e),h.call(this,t,e,i),this._prevBlock=n}}),f=f.CBC=u,u=(e.pad={}).Pkcs7={pad:function(t,e){for(var r=4*e,r=r-t.sigBytes%r,i=r<<24|r<<16|r<<8|r,s=[],o=0;r>o;o+=4)s.push(i);r=n.create(s,r),t.concat(r)},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},r.BlockCipher=a.extend({cfg:a.cfg.extend({mode:f,padding:u}),reset:function(){a.reset.call(this);var t=this.cfg,e=t.iv,t=t.mode;if(this._xformMode==this._ENC_XFORM_MODE)var r=t.createEncryptor;else r=t.createDecryptor,this._minBufferSize=1;this._mode=r.call(t,this,e&&e.words)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else e=this._process(!0),t.unpad(e);return e},blockSize:4});var p=r.CipherParams=i.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),f=(e.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext;return t=t.salt,(t?n.create([1398893684,1701076831]).concat(t).concat(e):e).toString(o)},parse:function(t){t=o.parse(t);var e=t.words;if(1398893684==e[0]&&1701076831==e[1]){var r=n.create(e.slice(2,4));e.splice(0,4),t.sigBytes-=16}return p.create({ciphertext:t,salt:r})}},d=r.SerializableCipher=i.extend({cfg:i.extend({format:f}),encrypt:function(t,e,r,i){i=this.cfg.extend(i);var n=t.createEncryptor(r,i);return e=n.finalize(e),n=n.cfg,p.create({ciphertext:e,key:r,iv:n.iv,algorithm:t,mode:n.mode,padding:n.padding,blockSize:t.blockSize,formatter:i.format})},decrypt:function(t,e,r,i){return i=this.cfg.extend(i),e=this._parse(e,i.format),t.createDecryptor(r,i).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}}),e=(e.kdf={}).OpenSSL={execute:function(t,e,r,i){return i||(i=n.random(8)),t=c.create({keySize:e+r}).compute(t,i),r=n.create(t.words.slice(e),4*r),t.sigBytes=4*e,p.create({key:t,iv:r,salt:i})}},l=r.PasswordBasedCipher=d.extend({cfg:d.cfg.extend({kdf:e}),encrypt:function(t,e,r,i){return i=this.cfg.extend(i),r=i.kdf.execute(r,t.keySize,t.ivSize),i.iv=r.iv,t=d.encrypt.call(this,t,e,r.key,i),t.mixIn(r),t},decrypt:function(t,e,r,i){return i=this.cfg.extend(i),e=this._parse(e,i.format),r=i.kdf.execute(r,t.keySize,t.ivSize,e.salt),i.iv=r.iv,d.decrypt.call(this,t,e,r.key,i)}})}(),function(){for(var t=CryptoJS,e=t.lib.BlockCipher,r=t.algo,i=[],n=[],s=[],o=[],c=[],a=[],f=[],h=[],u=[],p=[],d=[],l=0;256>l;l++)d[l]=128>l?l<<1:l<<1^283;for(var y=0,_=0,l=0;256>l;l++){var v=_^_<<1^_<<2^_<<3^_<<4,v=v>>>8^255&v^99;i[y]=v,n[v]=y;var g=d[y],B=d[g],m=d[B],x=257*d[v]^16843008*v;s[y]=x<<24|x>>>8,o[y]=x<<16|x>>>16,c[y]=x<<8|x>>>24,a[y]=x,x=16843009*m^65537*B^257*g^16843008*y,f[v]=x<<24|x>>>8,h[v]=x<<16|x>>>16,u[v]=x<<8|x>>>24,p[v]=x,y?(y=g^d[d[d[m^g]]],_^=d[d[_]]):y=_=1}var S=[0,1,2,4,8,16,32,64,128,27,54],r=r.AES=e.extend({_doReset:function(){for(var t=this._key,e=t.words,r=t.sigBytes/4,t=4*((this._nRounds=r+6)+1),n=this._keySchedule=[],s=0;t>s;s++)if(r>s)n[s]=e[s];else{var o=n[s-1];s%r?r>6&&4==s%r&&(o=i[o>>>24]<<24|i[o>>>16&255]<<16|i[o>>>8&255]<<8|i[255&o]):(o=o<<8|o>>>24,o=i[o>>>24]<<24|i[o>>>16&255]<<16|i[o>>>8&255]<<8|i[255&o],o^=S[s/r|0]<<24),n[s]=n[s-r]^o}for(e=this._invKeySchedule=[],r=0;t>r;r++)s=t-r,o=r%4?n[s]:n[s-4],e[r]=4>r||4>=s?o:f[i[o>>>24]]^h[i[o>>>16&255]]^u[i[o>>>8&255]]^p[i[255&o]]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,s,o,c,a,i)},decryptBlock:function(t,e){var r=t[e+1];t[e+1]=t[e+3],t[e+3]=r,this._doCryptBlock(t,e,this._invKeySchedule,f,h,u,p,n),r=t[e+1],t[e+1]=t[e+3],t[e+3]=r},_doCryptBlock:function(t,e,r,i,n,s,o,c){for(var a=this._nRounds,f=t[e]^r[0],h=t[e+1]^r[1],u=t[e+2]^r[2],p=t[e+3]^r[3],d=4,l=1;a>l;l++)var y=i[f>>>24]^n[h>>>16&255]^s[u>>>8&255]^o[255&p]^r[d++],_=i[h>>>24]^n[u>>>16&255]^s[p>>>8&255]^o[255&f]^r[d++],v=i[u>>>24]^n[p>>>16&255]^s[f>>>8&255]^o[255&h]^r[d++],p=i[p>>>24]^n[f>>>16&255]^s[h>>>8&255]^o[255&u]^r[d++],f=y,h=_,u=v;y=(c[f>>>24]<<24|c[h>>>16&255]<<16|c[u>>>8&255]<<8|c[255&p])^r[d++],_=(c[h>>>24]<<24|c[u>>>16&255]<<16|c[p>>>8&255]<<8|c[255&f])^r[d++],v=(c[u>>>24]<<24|c[p>>>16&255]<<16|c[f>>>8&255]<<8|c[255&h])^r[d++],p=(c[p>>>24]<<24|c[f>>>16&255]<<16|c[h>>>8&255]<<8|c[255&u])^r[d++],t[e]=y,t[e+1]=_,t[e+2]=v,t[e+3]=p},keySize:8});t.AES=e._createHelper(r)}();


var _hash = {
		init: SHA256_init,
		update: SHA256_write,
		getBytes: SHA256_finalize
	};

function simpleHash(message) {
		_hash.init();
		_hash.update(message);
		return _hash.getBytes();
	}

function byteArrayToBigInteger(byteArray, startIndex) {
		var value = new BigInteger("0", 10);
		var temp1, temp2;
		for (var i = byteArray.length - 1; i >= 0; i--) {
			temp1 = value.multiply(new BigInteger("256", 10));
			temp2 = temp1.add(new BigInteger(byteArray[i].toString(10), 10));
			value = temp2;
		}

		return value;
	}

	 function getPublicKey(secretPhrase) {
		
			var secretPhraseBytes = converters.stringToByteArray(secretPhrase);
			var digest = simpleHash(secretPhraseBytes);
			return curve25519.keygen(digest).p;
	}


	 function getAccountIdFromPublicKey(publicKey, RSFormat) {
		var hex = converters.hexStringToByteArray(publicKey);

		_hash.init();
		_hash.update(hex);

		var account = _hash.getBytes();

		account = converters.byteArrayToHexString(account);

		var slice = (converters.hexStringToByteArray(account)).slice(0, 8);

		var accountId = byteArrayToBigInteger(slice).toString();

		if (RSFormat) {
			var address = new NxtAddress();

			if (address.set(accountId)) {
				return address.toString();
			} else {
				return "";
			}
		} else {
			return accountId;
		}
	}

	function areByteArraysEqual(bytes1, bytes2) {
		if (bytes1.length !== bytes2.length)
			return false;

		for (var i = 0; i < bytes1.length; ++i) {
			if (bytes1[i] !== bytes2[i])
				return false;
		}

		return true;
	}

	
	 function verifyBytes(signature, message, publicKey) {
		var signatureBytes = signature;
		var messageBytes = message;
		var publicKeyBytes = publicKey;
		var v = signatureBytes.slice(0, 32);
		var h = signatureBytes.slice(32);
		var y = curve25519.verify(v, h, publicKeyBytes);

		var m = simpleHash(messageBytes);

		_hash.init();
		_hash.update(m);
		_hash.update(y);
		var h2 = _hash.getBytes();

		return areByteArraysEqual(h, h2);
	}

	 function signBytes(message, secretPhrase) {
		var messageBytes = message;
		var secretPhraseBytes = converters.stringToByteArray(secretPhrase);

		var digest = simpleHash(secretPhraseBytes);
		var s = curve25519.keygen(digest).s;

		var m = simpleHash(messageBytes);

		_hash.init();
		_hash.update(m);
		_hash.update(s);
		var x = _hash.getBytes();

		var y = curve25519.keygen(x).p;

		_hash.init();
		_hash.update(m);
		_hash.update(y);
		var h = _hash.getBytes();

		var v = curve25519.sign(h, x, s);

		return (v.concat(h));
	}

	function toByteArray(e){for(var a=[0,0,0,0],t=0;t<a.length;t++){var r=255&e;a[t]=r,e=(e-r)/256}return a}

	function createToken(e,a){var t=converters.stringToHexString(e),r=converters.hexStringToByteArray(t),n=[];n=r.concat(getPublicKey(a));var s=Math.round(+new Date/1e3),y=s-1385294400,o=toByteArray(y);n=n.concat(o);var c=[];c=getPublicKey(a).concat(o);var u=signBytes(n,a);c=c.concat(u);for(var i="",J=0;100>J;J+=5){var p=[];p[0]=255&c[J],p[1]=255&c[J+1],p[2]=255&c[J+2],p[3]=255&c[J+3],p[4]=255&c[J+4];var g=byteArrayToBigInteger(p);32>g?i+="0000000":1024>g?i+="000000":32768>g?i+="00000":1048576>g?i+="0000":33554432>g?i+="000":1073741824>g?i+="00":34359738368>g&&(i+="0"),i+=g.toString(32)}return i}
function parseToken(tokenString, website)
{
 		var websiteBytes = converters.stringToByteArray(website);
        var tokenBytes = [];
        var i = 0;
        var j = 0;

        for (; i < tokenString.length; i += 8, j += 5) {

        	var number = new BigInteger(tokenString.substring(i, i+8), 32);
            var part = converters.hexStringToByteArray(number.toRadix(16));

            tokenBytes[j] = part[4];
            tokenBytes[j + 1] = part[3];
            tokenBytes[j + 2] = part[2];
            tokenBytes[j + 3] = part[1];
            tokenBytes[j + 4] = part[0];

        }

        if (i != 160) {
            new Error("tokenString parsed to invalid size");
        }
        var publicKey = [];
        publicKey = tokenBytes.slice(0, 32);
        var timebytes = [tokenBytes[32], tokenBytes[33], tokenBytes[34], tokenBytes[35]];

        var timestamp = toIntVal(timebytes);
        var signature = tokenBytes.slice(36, 100);

        var data = websiteBytes.concat(tokenBytes.slice(0, 36));
       	
        var isValid = verifyBytes(signature, data, publicKey);

        var ret = {};
        ret.isValid = isValid;
        ret.timestamp = timestamp;
        ret.publicKey = converters.byteArrayToHexString(publicKey);

        return ret;

}

function passphrase() 
{
	var str = "";
	var random = new Uint32Array(12);
	crypto.getRandomValues(random);
	for(var a=0;a<12;a++)
	{
		if(a!=0) str += " ";
		str += words[random[a]%words.length];
	}
	return str;
}

function pad(length, val) {
    var array = [];
    for (var i = 0; i < length; i++) {
        array[i] = val;
    }
    return array;
}

function wordBytes(word)
{
	return [(word%256), Math.floor(word/256)];
}

function transaction(type, subtype, recip, amt, passphrase, message)
{
		// what to do... ok so lets generate the tx bytes

	var bytes = [];
	bytes.push(type);
	bytes.push((1 << 4) + subtype);
	var timestamp = Math.floor(Date.now() / 1000) - 1385294400;
	bytes = bytes.concat(converters.int32ToBytes(timestamp));
	bytes.push(160);
	bytes.push(5); // deadline
	bytes = bytes.concat(getPublicKey(passphrase));

	var rec = new NxtAddress();
	rec.set(recip);
	var recipient = (new BigInteger(rec.account_id())).toByteArray().reverse();
	if(recipient.length == 9) recipient = recipient.slice(0,8);
	while(recipient.length != 8) recipient.push(0);
	bytes = bytes.concat(recipient);

	var amount = ((new BigInteger(String(parseInt(amt*100000000))))).toByteArray().reverse();
	if(amount.length == 9) amount = amount.slice(0,8);
	while(amount.length != 8) amount.push(0);
	bytes = bytes.concat(amount);

	var fee = (converters.int32ToBytes(100000000))
	while(fee.length != 8) fee.push(0);
	bytes = bytes.concat(fee);

	bytes = bytes.concat(pad(32, 0)); // ref full hash
	bytes = bytes.concat(pad(64, 0));

	// message things here
	if(!message)
	{
		bytes = bytes.concat(pad(16));
	}
	else
	{
		bytes.push(1);
		bytes = bytes.concat(pad(15));
	}
	return bytes;
}

function addMessage(bytes, message)
{
	bytes.push(1); // version
	bytes = bytes.concat(wordBytes(message.length));
	bytes.push(0);
	bytes.push(128);
	bytes = bytes.concat(converters.stringToByteArray(message));
	return bytes;
}

function sign(bytes, passphrase)
{
	bytes = converters.hexStringToByteArray(converters.byteArrayToHexString(bytes)); // fix signs
	var sig = signBytes(bytes, PASSPHRASE);

	return bytes.slice(0, 96).concat(sig).concat(bytes.slice(96+64));
}

// formatJson() :: formats and indents JSON string
function formatJson(val) {
	var retval = '';
	var str = val;
    var pos = 0;
    var strLen = str.length;
	var indentStr = '&nbsp;&nbsp;&nbsp;&nbsp;';
    var newLine = '<br />';
	var char = '';
	
	for (var i=0; i<strLen; i++) {
		char = str.substring(i,i+1);
		
		if (char == '}' || char == ']') {
			retval = retval + newLine;
			pos = pos - 1;
			
			for (var j=0; j<pos; j++) {
				retval = retval + indentStr;
			}
		}
		
		retval = retval + char;	
		
		if (char == '{' || char == '[' || char == ',') {
			retval = retval + newLine;
			
			if (char == '{' || char == '[') {
				pos = pos + 1;
			}
			
			for (var k=0; k<pos; k++) {
				retval = retval + indentStr;
			}
		}
	}
	
	return retval;
}



var PASSPHRASE = "";
var rs = "";

